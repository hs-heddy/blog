# AWS Summit Tokyo 2017

* http://www.awssummit.tokyo/
* 2017 年 5 月 30 日（火）～ 6 月 2 日（金）

### [ワークスアプリケーションズ] AWS Lambda で変わるバッチの世界 ~ CPU 時間トータル 100 時間の処理を 10 分で終わらせるには~
* http://www.awssummit.tokyo/devday/index.html#D4T8-4
* D4T8-4
#### 導入
* 画面数9000のサイトのソース最適化を行うのに最初は100CPU時間かかっていた
* Apache Spark使って2時間まで短縮したが、利用リソースが読めずに大きなインスタンスを使わざるをえなかった
* これをLambdaに置き換えたらどこまで早く安くできるか
#### 構築
* 画面リストの作成・HTML最適化・jsコンパイル・CSSコンパイルに分ける
* HTML最適化:今まで1機能で最適化とコンパイルを同時に行っていたのを3機能に分割
* javascriptコンパイラは2016年11月のアップデートでメモリ利用量が大幅に削減され(最大15G→1G)てLambda上で実行できるようになった
* Lambdaでは実行中の状況が見えないので、実行開始や途中経過の表示にS3を使うことにした
#### トラブルシューティング
* 1：CPUが思ったより早くない→メモリを128Mから1536MBに増やすと自動的にCPUリソースも増える(単位時間あたりの費用3倍で実行時間1/3になったので総額は変わらず)
* 2：並列数が伸びない→VPCのサブネットの設定を確認(IPアドレス以上に並列できない)し不必要ならなくす
* 3：Lessコンパイルが起動後すぐにエラーになる→S3は結果整合性なので自分自身が作ったファイルでも必ず存在確認を行う
* 4：S3イベントが登録されない！登録したはずが消えている→一度に登録すれば100functionでも大丈夫
* 5：予想外の金額→ローカルファイルを都度cleanする、/tmpが引き継がれるので何回も実行するとLambdaストレージ課金が高くなる
#### 効果測定
* 10分30秒で終わらせる事が出来た
* 残課題：DBが高負荷になり、数個/8000page中のエラーが出る

-----

### もう悩まない！AWS SAM で始めるサーバーレスアプリケーション開発
* http://www.awssummit.tokyo/devday/index.html#D4T7-5
* D4T7-5

* AWS Serverless Application Modelとはサーバーレスアプリケーションの管理フレームワーク
* CloudFormationテンプレートとして提供
* githubにサンプルコードがある
* 今日はLambdaの話だけしたけど、他のCloudFormationテンプレート使えばEC2の作成等出来ます

### [グリッド] 分散並列による Deep Neural Network の最適化〜ディストリビューテッドパラメータ探索
* http://www.awssummit.tokyo/summit/index.html#D4T6-6
* D4T6-6

#### GRIT社とは
* 太陽光発電のパネル生産および発電マネージメント・発電事業
* それをやりながらAIの研究開発
* ReNom(レノーム)というDNN用フレームワークを作成

#### DNNと深層学習の課題
* アルゴリズムの選択・ハイパーパラメータのチューニング・学習環境時間の最適化
* 間違ったアルゴリズムを選択すると誤差が大きくなる
* ハイパーパラメータのチューニング：制度検証のラストワンマイルで現状でも手作業の職人芸
* このチューニングを最後の追い込みになるので、短時間だけど試行数だけのコンピュータリソースが必要(オンプレミスだと長時間待つか試行数を減らす必要あり)

#### ディストリビューテッドパラメータ探索
* 自動パラメータ探索とは：ランダムサーチ・グリットサーチ・ベイズサーチを使い、複数の学習を同時に行い最高の物を採用する
* 北アメリカのp2インスタンスは1時間あたり0.9ドル、これを4台で実験
* ハイパーパラメータは5種類各種2個(=全32通り)でテスト
* CNNモデルの種類と研究開発の動向：効率の良いモデルはGoogleやFacebookが作成
* 今回の32通り全部テストするのに66.67ドルかかった
* ちなみにGeForce1080Tiをオンプレミスで使う(10万円ぐらい)とp2インスタンスの5倍ぐらいの速度が出る
* が、GeForce1080Tiの減価償却には22日ほど計算が必要(だけど、普通はそんなに沢山学習するほどデータセットが無い)




-----

### JAWS-UG Night in AWS Summit Tokyo 2017 LT


#### 君の名は聖地巡礼システム
* 君の名は。聖地巡礼ナビ
* Movable Type for EC2で静的にHTMLを作成し、EC2にアップロード
* 運営コストは$1.5/week

#### EC2におけるバッチ運用について
* やりたかったこと：バッチを並列で走らせたい、バッチが落ちてもそこから再開させたい
* 60個のバッチを並列で走らせる事が出来た(これがEC2 APIの上限)

#### 安くて簡単！AWSでのデータ集積基盤構築
* 自社のコールセンターのKPIを可視化したい→1日でできました！

#### JAWS-UGのススメ
* メガネさんのいつものwave？！
* 今回LT応募7件しかなかった、俺が敷居を上げていると思うので引退します！
